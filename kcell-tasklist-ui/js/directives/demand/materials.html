<style>
    .list-group {
        border: 1px solid #428bca;
        position: absolute;
        z-index: 100;
        width: 100%;
        border-radius: 4px;
    }
    .list-group-input {
        border: 1px solid #ccc;
        border-radius: 4px;
        padding: 6px 12px;
        color: #555;
    }
    .list-group-input-active {
        border-color: #9b5fb9;
    }
    .list-group-input:hover,
    .list-group-input:focus {
        border-color: #9b5fb9;
        cursor: pointer;
    }
    .list-group-item {
        border: none;
        border-radius: 0;
        text-align: center;
    }
    .list-group-item:hover,
    .list-group-item:focus {
        color: #fff !important;
        background-color: #428bca !important;
        cursor: pointer;
        text-decoration: none;
    }
</style>
<div class="col-sm-12">
    <!--<div class="col-sm-12" ng-style="{'min-width': (disabled?(editprice?'1200px':'100%'):'1300px')}">-->
        <table class="table">
            <thead>
                <tr>
                    <th ng-style="{'width': (disabled?'auto':'8%')}">Dept.</th>
                    <th ng-style="{'width': (disabled?'auto':'14%')}">Material type</th>
                    <th ng-style="{'width': (disabled?'auto':'12%')}">Description</th>
                    <th ng-style="{'width': (disabled?'auto':'7%')}">Purchase group</th>
                    <th ng-style="{'width': (disabled?'auto':'7%')}">Quantity</th>
                    <th ng-style="{'width': (disabled?'auto':'10%')}">Measure</th>
                    <th ng-style="{'width': (disabled?'auto':'6%')}">Exists on Warehouse?</th>
                    <th ng-style="{'width': (disabled?(editprice?'8%':'auto'):'6%')}">Currency</th>
                    <th ng-style="{'width': (disabled?(editprice?'10%':'auto'):'8%')}">Price, Without VAT</th>
                    <th ng-style="{'width': (disabled?'auto':'8%')}">Amount, Without VAT</th>
                    <th ng-style="{'width': (disabled?'auto':'10%')}">Responsible</th>
                    <th ng-style="{'width': (disabled?'auto':'4%')}" ng-if="!disabled">
                        <a href="#" ng-click="addItem()" style="font-size: 25px;">
                            <span class="glyphicon glyphicon-plus-sign"></span>
                        </a>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="r in data track by $index">
                    <td>
                        <span ng-if="disabled">{{r.department}}</span>
                        <span ng-if="!disabled">
                            <select class="form-control" ng-model="r.department" name="materials_{{$index}}_department" ng-change="onDepartmentChange($index)" required>
                                <option value="B2B">B2B</option>
                                <option value="B2C">B2C</option>
                                <option value="CCD">CCD</option>
                                <option value="CEO">CEO</option>
                                <option value="CPD">CPD</option>
                                <option value="FD">FD</option>
                                <option value="HR">HR</option>
                                <option value="LD">LD</option>
                                <option value="TD">TD</option>
                            </select>
                            <span class="has-error" ng-if="form['materials_'+$index+'_department'].$error.required && ( form['materials_'+$index+'_department'].$touched || view.submitted)">Required field</span>
                        </span>
                    </td>
                    <td>
                        <span ng-if="disabled">{{r.materialType.v}}</span>
                        <span ng-if="!disabled">
                            <div ng-dropdown-multiselect="" options="options.materialType" selected-model="r.materialType" extra-settings="multiselectSettings" events="multiselectEvents"></div>
                            <span class="has-error" ng-if="(!r.materialType || !r.materialType.v) && view.submitted">Required field</span>
                        </span>
                    </td>
                    <td>
                        <span ng-if="disabled || r.materialType.v != 'New Equipment'">{{r.description}}</span>
                        <span ng-if="!disabled && r.materialType.v == 'New Equipment'">
                            <textarea rows="1" elastic-textarea class="form-control" ng-model="r.description" name="materials_{{$index}}_description" ng-change="setResponsible($index)" required></textarea>
                            <span class="has-error" ng-if="form['materials_'+$index+'_description'].$error.required && ( form['materials_'+$index+'_description'].$touched || view.submitted)">Required field</span>
                        </span>
                    </td>
                    <td>
                        <span ng-if="disabled" title="{{r.purchaseGroup.t}}">{{r.purchaseGroup.v}}</span>
                        <span ng-if="!disabled">
                            <div ng-click="toggleSelect($index)" class="col-sm-12 list-group-input" ng-class="{'list-group-input-active':isOpen[$index]}" title="{{r.purchaseGroup.t}}">
                                {{r.purchaseGroup.v?r.purchaseGroup.v:'&nbsp;'}}
                                <span class="caret" style="position: absolute; right: 5px; top: 45%; font-size: 10px;"></span>
                            </div>
                            <div class="col-sm-12" style="padding: 0;" ng-show="isOpen[$index]">
                                <ul class="list-group">
                                    <li class="list-group-item" title="{{option.t}}" ng-click="selectOption($parent.$index, option)" ng-repeat="option in options.purchaseGroup">
                                        {{option.v}}
                                    </li>
                                </ul>
                            </div>
                            <input type="hidden" ng-model="r.purchaseGroup" name="materials_{{$index}}_purchaseGroup" ng-change="setResponsible($index)" required>
                            <span class="has-error" ng-if="form['materials_'+$index+'_purchaseGroup'].$error.required && ( form['materials_'+$index+'_purchaseGroup'].$touched || view.submitted)">Required field</span>
                        </span>
                    </td>
                    <td>
                        <span ng-if="disabled">{{r.quantity}}</span>
                        <span ng-if="!disabled">
                            <input type="number" class="form-control" ng-model="r.quantity" name="materials_{{$index}}_quantity" ng-change="calcSumm($index)" required>
                            <span class="has-error" ng-if="form['materials_'+$index+'_quantity'].$error.required && ( form['materials_'+$index+'_quantity'].$touched || view.submitted)">Required field</span>
                        </span>
                    </td>
                    <td>
                        <span ng-if="disabled">{{r.measure}}</span>
                        <span ng-if="!disabled">
                            <select class="form-control" ng-model="r.measure" name="materials_{{$index}}_measure" ng-change="setResponsible($index)" required>
                                <option value="Pcs">Pcs</option>
                                <option value="Bundle">Bundle</option>
                                <option value="Kit">Kit</option>
                            </select>
                            <span class="has-error" ng-if="form['materials_'+$index+'_measure'].$error.required && ( form['materials_'+$index+'_measure'].$touched || view.submitted)">Required field</span>
                        </span>
                    </td>
                    <td>
                        <input type="checkbox" ng-model="r.existing" ng-change="setResponsible($index)" ng-disabled="!editexisting">
                    </td>
                    <td>
                        <span ng-if="!editprice">{{r.currency}}</span>
                        <span ng-if="editprice">
                            <select class="form-control" ng-model="r.currency" name="materials_{{$index}}_currency" ng-change="setResponsible($index)" required>
                                <option value="KZT">KZT</option>
                                <option value="USD">USD</option>
                                <option value="EUR">EUR</option>
                                <option value="GBP">GBP</option>
                                <option value="RUB">RUR</option>
                            </select>
                            <span class="has-error" ng-if="form['materials_'+$index+'_currency'].$error.required && ( form['materials_'+$index+'_currency'].$touched || view.submitted)">Required field</span>
                        </span>
                    </td>
                    <td>
                        <span ng-if="!editprice">{{r.pprice | number}}</span>
                        <span ng-if="editprice">
                            <input type="text" class="form-control" ng-model="r.pprice" name="materials_{{$index}}_pprice" ng-change="calcSumm($index)" demand-number-format required>
                            <span class="has-error" ng-if="form['materials_'+$index+'_pprice'].$error.required && ( form['materials_'+$index+'_pprice'].$touched || view.submitted)">Required field</span>
                        </span>
                    </td>
                    <td>
                        {{r.summ | number}}
                    </td>
                    <td>
                        {{r.responsible.fio}}
                    </td>
                    <td ng-if="!disabled">
                        <button type="button" class="btn btn-default" ng-click="deleteItem($index)">Delete</button>
                    </td>
                </tr>
            </tbody>
        </table>
    <!--</div>-->
</div>