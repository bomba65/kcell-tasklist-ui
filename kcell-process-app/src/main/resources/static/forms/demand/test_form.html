<form role="form" class="form-horizontal" name="kcell_form" novalidate>
    <script cam-script type="text/form-script">
    inject(['$scope', '$q', '$http', '$rootScope', function ($scope, $q, $http, $rootScope) {
        $scope.generalData = {};
        $scope.detailsData = {};
        $scope.targetAudienceData = {};
        camForm.on('form-loaded', function() {
            camForm.variableManager.fetchVariable('generalData');
            camForm.variableManager.fetchVariable('detailsData');
            camForm.variableManager.fetchVariable('targetAudienceData');
        });
        camForm.on('variables-fetched', function() {
            $scope.generalData = camForm.variableManager.variableValue('generalData');
            $scope.detailsData = camForm.variableManager.variableValue('detailsData');
            $scope.targetAudienceData = camForm.variableManager.variableValue('targetAudienceData');
            if (!$scope.generalData) $scope.generalData = {};
            if (!$scope.detailsData) $scope.detailsData = {};
            if (!$scope.targetAudienceData) $scope.targetAudienceData = {};
        });
        camForm.on('submit', function() {
            camForm.variableManager.destroyVariable('generalData');
            camForm.variableManager.createVariable({
                name: 'generalData',
                type: 'Json',
                value: $scope.generalData
            });
            camForm.variableManager.destroyVariable('detailsData');
            camForm.variableManager.createVariable({
                name: 'detailsData',
                type: 'Json',
                value: $scope.detailsData
            });
            camForm.variableManager.destroyVariable('targetAudienceData');
            camForm.variableManager.createVariable({
                name: 'targetAudienceData',
                type: 'Json',
                value: $scope.targetAudienceData
            });
        });
    }]);
    </script>
    <h3><b>Demand & AOP</b></h3>
    <h4>Проверка работоспособности директива</h4>
    <!--<div class="col-sm-12">
        <demand-general data="generalData" form="kcell_form" view="view" readonly="false"></demand-general>
    </div>-->
    <!-- <div class="col-sm-12">
        <demand-details data="detailsData" form="kcell_form" view="view" readonly="false"></demand-details>
    </div> -->
    <div class="col-sm-12">
        <demand-target-audience data="targetAudienceData" form="kcell_form" view="view" readonly="false"></demand-target-audience>
    </div>
</form>