import groovy.json.JsonSlurper
import groovy.text.markup.MarkupTemplateEngine
import groovy.text.markup.TemplateConfiguration
import groovy.json.JsonSlurper

//def selectedRevisions = '{"ac798f5a-09f4-11eb-900c-0242ac120008":{"selected":true,"businessKey":"Astana-Line_Eng-SAO-20-7002","processInstanceId":"ac798f5a-09f4-11eb-900c-0242ac120008","$$hashKey":"object:488","performDate":"2020-10-14T17:04:45.987+0600","priority":"regular","site_name":"11973KYZYLNEW","acceptanceDate":"2020-10-14T00:00:00.000+0600","contractorJobAssignedDate":"2020-10-13T15:23:24.273+0600","siteRegion":"astana","reason":"4","acceptWorkStartTime":"2020-10-14T17:04:45.987+0600","acceptWorkEndTime":"2020-10-14T00:00:00.000+0600","works":[{"relatedSites":[{"name":"11973","id":"30325","site_name":"11973KYZYLNEW","params":{"status":{"11973KYZYL":"replaced"},"site_name":"11973KYZYL,11973KYZYLNEW"},"$$hashKey":"object:187"}],"displayServiceName":"2.47 Замена аккумуляторных батарей ;Комплект- 4шт","sapServiceNumber":"2.47","materialUnit":"Комплект-4шт","quantity":2,"materialQuantity":2,"reason":"change_improvement","expenseType":"CAPEX","reasonDetail":"Замена - восстановление вышедшего из строя оборудования/ОС для улучшения состояния объекта, повышающего его первоначально оцененные нормативные показатели: срок службы, производственную мощность и т. д","$$hashKey":"object:151","files":[{"name":"work_0_file_0","type":"Json","value":{"name":"JR Astana-Line_Eng-SAO-20-7002_11973KYZYLNEW.zip","path":"ac798f5a-09f4-11eb-900c-0242ac120008/0b84dabc-0d46-11eb-900c-0242ac120008/JR Astana-Line_Eng-SAO-20-7002_11973KYZYLNEW.zip"},"$$hashKey":"object:1309"}]}],"workPrices":[{"relatedSites":[{"name":"11973","id":"30325","site_name":"11973KYZYLNEW","params":{"status":{"11973KYZYL":"replaced"},"site_name":"11973KYZYL,11973KYZYLNEW"},"$$hashKey":"object:187"}],"displayServiceName":"2.47 Замена аккумуляторных батарей ;Комплект- 4шт","sapServiceNumber":"2.47","materialUnit":"Комплект-4шт","quantity":2,"materialQuantity":2,"reason":"change_improvement","expenseType":"CAPEX","reasonDetail":"Замена - восстановление вышедшего из строя оборудования/ОС для улучшения состояния объекта, повышающего его первоначально оцененные нормативные показатели: срок службы, производственную мощность и т. д","$$hashKey":"object:151","unitWorkPricePerSite":"44400.00","netWorkPricePerSite":"88800.00","unitWorkPrice":"44400.00","unitWorkPricePlusTx":"44400.00","basePriceByQuantity":"88800.00","total":"88800.00","basePrice":"44400.00","materialsProvidedBy":"kcell"}]},"bdf09ce5-0884-11eb-9944-0242ac120008":{"selected":true,"businessKey":"South-Line_Eng-P&O-20-7004","processInstanceId":"bdf09ce5-0884-11eb-9944-0242ac120008","$$hashKey":"object:494","performDate":"2020-10-21T11:53:09.727+0600","priority":"emergency","site_name":"41407NURSTEATR","acceptanceDate":"2020-10-30T00:00:00.000+0600","contractorJobAssignedDate":"2020-10-16T12:00:45.188+0600","siteRegion":"south","reason":"1","acceptWorkStartTime":"2020-10-21T11:53:09.727+0600","acceptWorkEndTime":"2020-10-30T00:00:00.000+0600","works":[{"relatedSites":[{"name":"41407","id":"32651","site_name":"41407NURSTEATR","params":{"site_name":"41407NURSTEATR,41407NURSTEATR2"},"$$hashKey":"object:1355"},{"name":"41407","id":"32651","site_name":"41407NURSTEATR2","params":{"site_name":"41407NURSTEATR,41407NURSTEATR2"},"$$hashKey":"object:1356"}],"displayServiceName":"3.26 Перемещение фидера ;метр","sapServiceNumber":"3.27","materialUnit":"метр","quantity":120,"materialQuantity":120,"reason":"removal","expenseType":"OPEX","reasonDetail":"Демонтаж - снятие оборудования","files":[],"$$hashKey":"object:1225"},{"relatedSites":[{"name":"41407","id":"32651","site_name":"41407NURSTEATR","params":{"site_name":"41407NURSTEATR,41407NURSTEATR2"},"$$hashKey":"object:1366"},{"name":"41407","id":"32651","site_name":"41407NURSTEATR2","params":{"site_name":"41407NURSTEATR,41407NURSTEATR2"},"$$hashKey":"object:1367"}],"displayServiceName":"3.30 Перемещение оптического кабеля RRU ;метр","sapServiceNumber":"3.31","materialUnit":"метр","quantity":180,"materialQuantity":180,"reason":"removal","expenseType":"OPEX","reasonDetail":"Демонтаж - снятие оборудования","files":[],"$$hashKey":"object:1226"},{"relatedSites":[{"name":"41407","id":"32651","site_name":"41407NURSTEATR","$$hashKey":"object:1377"}],"sapServiceNumber":"3.41","materialUnit":"метр","quantity":180,"materialQuantity":180,"reason":"removal","expenseType":"OPEX","reasonDetail":"Демонтаж - снятие оборудования","$$hashKey":"object:1227","files":[]},{"relatedSites":[{"name":"41407","id":"32651","site_name":"41407NURSTEATR","$$hashKey":"object:1386"}],"sapServiceNumber":"3.23","materialUnit":"метр","quantity":120,"materialQuantity":120,"reason":"installation","expenseType":"CAPEX","reasonDetail":"Монтаж - установка нового оборудования","$$hashKey":"object:1228","files":[]},{"relatedSites":[{"name":"41407","id":"32651","site_name":"41407NURSTEATR","$$hashKey":"object:1395"}],"sapServiceNumber":"3.28","materialUnit":"метр","quantity":180,"materialQuantity":180,"reason":"installation","expenseType":"CAPEX","reasonDetail":"Монтаж - установка нового оборудования","$$hashKey":"object:1229","files":[]},{"relatedSites":[{"name":"41407","id":"32651","site_name":"41407NURSTEATR","$$hashKey":"object:1404"}],"sapServiceNumber":"3.32","materialUnit":"метр","quantity":180,"materialQuantity":180,"reason":"installation","expenseType":"CAPEX","reasonDetail":"Монтаж - установка нового оборудования","$$hashKey":"object:1230","files":[]}],"workPrices":[{"relatedSites":[{"name":"41407","id":"32651","site_name":"41407NURSTEATR","params":{"site_name":"41407NURSTEATR,41407NURSTEATR2"},"$$hashKey":"object:1355"},{"name":"41407","id":"32651","site_name":"41407NURSTEATR2","params":{"site_name":"41407NURSTEATR,41407NURSTEATR2"},"$$hashKey":"object:1356"}],"displayServiceName":"3.26 Перемещение фидера ;метр","sapServiceNumber":"3.27","materialUnit":"метр","quantity":120,"materialQuantity":120,"reason":"removal","expenseType":"OPEX","reasonDetail":"Демонтаж - снятие оборудования","files":[],"$$hashKey":"object:1225","unitWorkPricePerSite":"550.35","netWorkPricePerSite":"66041.40","unitWorkPrice":"1100.69","unitWorkPricePlusTx":"1100.69","basePriceByQuantity":"132082.80","total":"132082.80","basePrice":"1100.69","materialsProvidedBy":"kcell"},{"relatedSites":[{"name":"41407","id":"32651","site_name":"41407NURSTEATR","params":{"site_name":"41407NURSTEATR,41407NURSTEATR2"},"$$hashKey":"object:1366"},{"name":"41407","id":"32651","site_name":"41407NURSTEATR2","params":{"site_name":"41407NURSTEATR,41407NURSTEATR2"},"$$hashKey":"object:1367"}],"displayServiceName":"3.30 Перемещение оптического кабеля RRU ;метр","sapServiceNumber":"3.31","materialUnit":"метр","quantity":180,"materialQuantity":180,"reason":"removal","expenseType":"OPEX","reasonDetail":"Демонтаж - снятие оборудования","files":[],"$$hashKey":"object:1226","unitWorkPricePerSite":"160.88","netWorkPricePerSite":"28957.50","unitWorkPrice":"321.75","unitWorkPricePlusTx":"321.75","basePriceByQuantity":"57915.00","total":"57915.00","basePrice":"321.75","materialsProvidedBy":"kcell"},{"relatedSites":[{"name":"41407","id":"32651","site_name":"41407NURSTEATR","$$hashKey":"object:1377"}],"sapServiceNumber":"3.41","materialUnit":"метр","quantity":180,"materialQuantity":180,"reason":"removal","expenseType":"OPEX","reasonDetail":"Демонтаж - снятие оборудования","$$hashKey":"object:1227","unitWorkPricePerSite":"1607.26","netWorkPricePerSite":"289306.80","unitWorkPrice":"1607.26","unitWorkPricePlusTx":"1607.26","basePriceByQuantity":"289306.80","total":"289306.80","basePrice":"1607.26","materialsProvidedBy":"kcell"},{"relatedSites":[{"name":"41407","id":"32651","site_name":"41407NURSTEATR","$$hashKey":"object:1386"}],"sapServiceNumber":"3.23","materialUnit":"метр","quantity":120,"materialQuantity":120,"reason":"installation","expenseType":"CAPEX","reasonDetail":"Монтаж - установка нового оборудования","$$hashKey":"object:1228","unitWorkPricePerSite":"1371.20","netWorkPricePerSite":"164544.00","unitWorkPrice":"1371.20","unitWorkPricePlusTx":"1371.20","basePriceByQuantity":"164544.00","total":"164544.00","basePrice":"1371.20","materialsProvidedBy":"kcell"},{"relatedSites":[{"name":"41407","id":"32651","site_name":"41407NURSTEATR","$$hashKey":"object:1395"}],"sapServiceNumber":"3.28","materialUnit":"метр","quantity":180,"materialQuantity":180,"reason":"installation","expenseType":"CAPEX","reasonDetail":"Монтаж - установка нового оборудования","$$hashKey":"object:1229","unitWorkPricePerSite":"643.50","netWorkPricePerSite":"115830.00","unitWorkPrice":"643.50","unitWorkPricePlusTx":"643.50","basePriceByQuantity":"115830.00","total":"115830.00","basePrice":"643.50","materialsProvidedBy":"kcell"},{"relatedSites":[{"name":"41407","id":"32651","site_name":"41407NURSTEATR","$$hashKey":"object:1404"}],"sapServiceNumber":"3.32","materialUnit":"метр","quantity":180,"materialQuantity":180,"reason":"installation","expenseType":"CAPEX","reasonDetail":"Монтаж - установка нового оборудования","$$hashKey":"object:1230","unitWorkPricePerSite":"1467.18","netWorkPricePerSite":"264092.40","unitWorkPrice":"1467.18","unitWorkPricePlusTx":"1467.18","basePriceByQuantity":"264092.40","total":"264092.40","basePrice":"1467.18","materialsProvidedBy":"kcell"}],"dueDate":"2021-03-05T18:00:00.000Z","delay":5},"5b14350b-0306-11eb-b2c9-0242ac120008":{"selected":true,"businessKey":"West-Line_Eng-TNU-20-7003","processInstanceId":"5b14350b-0306-11eb-b2c9-0242ac120008","$$hashKey":"object:490","performDate":"2020-10-29T12:07:33.170+0600","priority":"regular","site_name":"62058GANUSHRUT","acceptanceDate":"2020-10-30T00:00:00.000+0600","contractorJobAssignedDate":"2020-10-21T18:07:24.381+0600","siteRegion":"west","reason":"2","acceptWorkStartTime":"2020-10-29T12:07:33.170+0600","acceptWorkEndTime":"2020-10-30T00:00:00.000+0600","works":[{"relatedSites":[{"name":"62058","id":"34632","site_name":"62058GANUSHRUT","params":{"site_name":"62058GANUSHRUT"},"$$hashKey":"object:3627"}],"displayServiceName":"9.59 Монтаж кабеля/патчкорда UTP, KVSM, FO ;метр","sapServiceNumber":"9.59","quantity":70,"materialQuantity":70,"reason":"installation","expenseType":"CAPEX","reasonDetail":"Монтаж - установка нового оборудования","$$hashKey":"object:3544","files":[{"name":"work_0_file_0","type":"Json","value":{"name":"West-Line_Eng-TNU-20-7003 62058GANUSHRUT.xlsx","path":"5b14350b-0306-11eb-b2c9-0242ac120008/afd037f7-19ac-11eb-80ef-0242ac120008/West-Line_Eng-TNU-20-7003 62058GANUSHRUT.xlsx"},"$$hashKey":"object:302"},{"name":"work_0_file_1","type":"Json","value":{"name":"West-Line_Eng-TNU-20-7003 62058GANUSHRUT ACT TRANSFER.xlsx","path":"5b14350b-0306-11eb-b2c9-0242ac120008/afd037f7-19ac-11eb-80ef-0242ac120008/West-Line_Eng-TNU-20-7003 62058GANUSHRUT ACT TRANSFER.xlsx"},"$$hashKey":"object:303"},{"name":"work_0_file_2","type":"Json","value":{"name":"West-Line_Eng-TNU-20-7003 62058GANUSHRUT.docx","path":"5b14350b-0306-11eb-b2c9-0242ac120008/afd037f7-19ac-11eb-80ef-0242ac120008/West-Line_Eng-TNU-20-7003 62058GANUSHRUT.docx"},"$$hashKey":"object:304"}]},{"relatedSites":[{"name":"62058","id":"34632","site_name":"62058GANUSHRUT","params":{"site_name":"62058GANUSHRUT"},"$$hashKey":"object:3636"}],"displayServiceName":"9.59 Монтаж кабеля/патчкорда UTP, KVSM, FO ;метр","sapServiceNumber":"9.59","quantity":70,"materialQuantity":70,"reason":"installation","expenseType":"CAPEX","reasonDetail":"Монтаж - установка нового оборудования","$$hashKey":"object:3545","files":[]}],"workPrices":[{"relatedSites":[{"name":"62058","id":"34632","site_name":"62058GANUSHRUT","params":{"site_name":"62058GANUSHRUT"},"$$hashKey":"object:3627"}],"displayServiceName":"9.59 Монтаж кабеля/патчкорда UTP, KVSM, FO ;метр","sapServiceNumber":"9.59","quantity":70,"materialQuantity":70,"reason":"installation","expenseType":"CAPEX","reasonDetail":"Монтаж - установка нового оборудования","$$hashKey":"object:3544","unitWorkPricePerSite":"1306.44","netWorkPricePerSite":"91450.80","unitWorkPrice":"1306.44","unitWorkPricePlusTx":"1306.44","basePriceByQuantity":"91450.80","total":"91450.80","basePrice":"1306.44"},{"relatedSites":[{"name":"62058","id":"34632","site_name":"62058GANUSHRUT","params":{"site_name":"62058GANUSHRUT"},"$$hashKey":"object:3636"}],"displayServiceName":"9.59 Монтаж кабеля/патчкорда UTP, KVSM, FO ;метр","sapServiceNumber":"9.59","quantity":70,"materialQuantity":70,"reason":"installation","expenseType":"CAPEX","reasonDetail":"Монтаж - установка нового оборудования","$$hashKey":"object:3545","unitWorkPricePerSite":"1306.44","netWorkPricePerSite":"91450.80","unitWorkPrice":"1306.44","unitWorkPricePlusTx":"1306.44","basePriceByQuantity":"91450.80","total":"91450.80","basePrice":"1306.44"}]},"27794c60-0ad3-11eb-900c-0242ac120008":{"selected":true,"businessKey":"N&C-Line_Eng-SAO-20-7003","processInstanceId":"27794c60-0ad3-11eb-900c-0242ac120008","$$hashKey":"object:489","performDate":"2020-11-18T09:45:38.704+0600","priority":"regular","site_name":"24070NURZHEZ","acceptanceDate":"2020-11-24T00:00:00.000+0600","contractorJobAssignedDate":"2020-10-20T12:32:26.587+0600","siteRegion":"nc","reason":"4","acceptWorkStartTime":"2020-11-18T09:45:38.704+0600","acceptWorkEndTime":"2020-11-24T00:00:00.000+0600","works":[{"relatedSites":[{"name":"24070","id":"31661","site_name":"24070NURZHEZ","params":{"site_name":"24070NURZHEZ"},"$$hashKey":"object:369"}],"displayServiceName":"3.30 Перемещение оптического кабеля RRU ;метр","sapServiceNumber":"3.30","materialUnit":"метр","quantity":270,"materialQuantity":270,"reason":"replacement","expenseType":"OPEX","reasonDetail":"Перемещение - в пределах одного сайта","$$hashKey":"object:284","files":[{"name":"work_0_file_0","type":"Json","value":{"name":"N&C-LSE-SAO-20-7003_24070NURZHEZ.rar","path":"27794c60-0ad3-11eb-900c-0242ac120008/f8905301-2400-11eb-a45d-0242ac120007/N&C-LSE-SAO-20-7003_24070NURZHEZ.rar"},"$$hashKey":"object:169"}]},{"relatedSites":[],"displayServiceName":"3.40 Перемещение кабеля питания RRU ;метр","sapServiceNumber":"3.40","materialUnit":"метр","quantity":270,"materialQuantity":270,"reason":"replacement","expenseType":"OPEX","reasonDetail":"Перемещение - в пределах одного сайта","$$hashKey":"object:285","files":[]},{"relatedSites":[],"displayServiceName":"3.48 Перемещение кабельных каналов лестничного типа вне помещений ;метр","sapServiceNumber":"3.48","materialUnit":"метр","quantity":55,"materialQuantity":55,"reason":"replacement","expenseType":"OPEX","reasonDetail":"Перемещение - в пределах одного сайта","$$hashKey":"object:286","files":[]},{"relatedSites":[],"displayServiceName":"9.55 Замена MW Feeder/cable ;метр","sapServiceNumber":"9.55","materialUnit":"метр","quantity":25,"materialQuantity":25,"reason":"replacement","expenseType":"OPEX","reasonDetail":"Перемещение - в пределах одного сайта","$$hashKey":"object:287","files":[]}],"workPrices":[{"relatedSites":[{"name":"24070","id":"31661","site_name":"24070NURZHEZ","params":{"site_name":"24070NURZHEZ"},"$$hashKey":"object:369"}],"displayServiceName":"3.30 Перемещение оптического кабеля RRU ;метр","sapServiceNumber":"3.30","materialUnit":"метр","quantity":270,"materialQuantity":270,"reason":"replacement","expenseType":"OPEX","reasonDetail":"Перемещение - в пределах одного сайта","files":[{"name":"work_0_file_0","type":"Json","value":{"name":"N&C-LSE-SAO-20-7003_24070NURZHEZ.rar","path":"27794c60-0ad3-11eb-900c-0242ac120008/f8905301-2400-11eb-a45d-0242ac120007/N&C-LSE-SAO-20-7003_24070NURZHEZ.rar"},"$$hashKey":"object:169"}],"unitWorkPricePerSite":"1158.30","netWorkPricePerSite":"312741.00","unitWorkPrice":"1158.30","unitWorkPricePlusTx":"1158.30","basePriceByQuantity":"312741.00","total":"312741.00","basePrice":"1158.30"},{"relatedSites":[],"displayServiceName":"3.40 Перемещение кабеля питания RRU ;метр","sapServiceNumber":"3.40","materialUnit":"метр","quantity":270,"materialQuantity":270,"reason":"replacement","expenseType":"OPEX","reasonDetail":"Перемещение - в пределах одного сайта","files":[],"unitWorkPricePerSite":"2487.87","netWorkPricePerSite":"671724.90","unitWorkPrice":"2487.87","unitWorkPricePlusTx":"2487.87","basePriceByQuantity":"671724.90","total":"671724.90","basePrice":"2487.87"},{"relatedSites":[],"displayServiceName":"3.48 Перемещение кабельных каналов лестничного типа вне помещений ;метр","sapServiceNumber":"3.48","materialUnit":"метр","quantity":55,"materialQuantity":55,"reason":"replacement","expenseType":"OPEX","reasonDetail":"Перемещение - в пределах одного сайта","files":[],"unitWorkPricePerSite":"2937.00","netWorkPricePerSite":"161535.00","unitWorkPrice":"2937.00","unitWorkPricePlusTx":"2937.00","basePriceByQuantity":"161535.00","total":"161535.00","basePrice":"2937.00"},{"relatedSites":[],"displayServiceName":"9.55 Замена MW Feeder/cable ;метр","sapServiceNumber":"9.55","materialUnit":"метр","quantity":25,"materialQuantity":25,"reason":"replacement","expenseType":"OPEX","reasonDetail":"Перемещение - в пределах одного сайта","files":[],"unitWorkPricePerSite":"1672.70","netWorkPricePerSite":"41817.50","unitWorkPrice":"1672.70","unitWorkPricePlusTx":"1672.70","basePriceByQuantity":"41817.50","total":"41817.50","basePrice":"1672.70"}]},"bd2b7965-18f1-11eb-98fc-0242ac120008":{"selected":true,"businessKey":"W-Line_Eng-P&O-20-7005","processInstanceId":"bd2b7965-18f1-11eb-98fc-0242ac120008","$$hashKey":"object:498","performDate":"2020-11-10T15:04:46.334+0600","priority":"regular","site_name":"71182AKORAZ","acceptanceDate":"2020-11-16T00:00:00.000+0600","contractorJobAssignedDate":"2020-10-29T14:25:12.764+0600","siteRegion":"west","reason":"1","acceptWorkStartTime":"2020-11-10T15:04:46.334+0600","acceptWorkEndTime":"2020-11-16T00:00:00.000+0600","works":[{"relatedSites":[{"name":"71182","id":"34861","site_name":"71182AKORAZ","params":{"status":{"71182AKORAZ":"will be dismantled"},"site_name":"71182AKORAZ"},"$$hashKey":"object:225"}],"displayServiceName":"2.4 Демонтаж сайта ;сайт","sapServiceNumber":"2.4","materialUnit":"сайт","quantity":1,"materialQuantity":1,"reason":"removal","expenseType":"OPEX","reasonDetail":"Демонтаж - снятие оборудования","files":[{"name":"work_0_file_0","type":"Json","value":{"name":"71182AKORAZ.doc","path":"bd2b7965-18f1-11eb-98fc-0242ac120008/43d8aa19-19c0-11eb-80ef-0242ac120008/71182AKORAZ.doc"},"$$hashKey":"object:133"},{"name":"work_0_file_1","type":"Json","value":{"name":"71182AKORAZ.xls","path":"bd2b7965-18f1-11eb-98fc-0242ac120008/43d8aa19-19c0-11eb-80ef-0242ac120008/71182AKORAZ.xls"},"$$hashKey":"object:134"}],"materialsProvidedBy":"subcontractor","unitWorkPricePerSite":"653400.00","netWorkPricePerSite":"653400.00","unitWorkPrice":"653400.00","unitWorkPricePlusTx":"653400.00","basePriceByQuantity":"653400.00","total":"653400.00","basePrice":"653400.00","$$hashKey":"object:603"}],"workPrices":[{"relatedSites":[{"name":"71182","id":"34861","site_name":"71182AKORAZ","params":{"status":{"71182AKORAZ":"will be dismantled"},"site_name":"71182AKORAZ"},"$$hashKey":"object:225"}],"displayServiceName":"2.4 Демонтаж сайта ;сайт","sapServiceNumber":"2.4","materialUnit":"сайт","quantity":1,"materialQuantity":1,"reason":"removal","expenseType":"OPEX","reasonDetail":"Демонтаж - снятие оборудования","files":[{"name":"work_0_file_0","type":"Json","value":{"name":"71182AKORAZ.doc","path":"bd2b7965-18f1-11eb-98fc-0242ac120008/43d8aa19-19c0-11eb-80ef-0242ac120008/71182AKORAZ.doc"},"$$hashKey":"object:133"},{"name":"work_0_file_1","type":"Json","value":{"name":"71182AKORAZ.xls","path":"bd2b7965-18f1-11eb-98fc-0242ac120008/43d8aa19-19c0-11eb-80ef-0242ac120008/71182AKORAZ.xls"},"$$hashKey":"object:134"}],"materialsProvidedBy":true,"unitWorkPricePerSite":"653400.00","netWorkPricePerSite":"653400.00","unitWorkPrice":"653400.00","unitWorkPricePlusTx":"653400.00","basePriceByQuantity":"653400.00","total":"653400.00","basePrice":"653400.00"}]},"5d4e4527-03b0-11eb-852a-0242ac120008":{"selected":true,"businessKey":"West-Line_Eng-SAO-20-7001","processInstanceId":"5d4e4527-03b0-11eb-852a-0242ac120008","$$hashKey":"object:487","performDate":"2020-11-16T12:10:17.346+0600","priority":"emergency","site_name":"62228SAGYZBAZA","acceptanceDate":"2020-11-16T00:00:00.000+0600","contractorJobAssignedDate":"2020-10-07T09:03:00.960+0600","siteRegion":"west","reason":"4","acceptWorkStartTime":"2020-11-16T12:10:17.346+0600","acceptWorkEndTime":"2020-11-16T00:00:00.000+0600","works":[{"relatedSites":[{"name":"62228","id":"34732","site_name":"62228SAGYZBAZA","params":{"site_name":"62228SAGYZBAZA"},"$$hashKey":"object:4395"}],"displayServiceName":"2.47 Замена аккумуляторных батарей ;Комплект- 4шт","sapServiceNumber":"2.47","quantity":2,"materialQuantity":2,"reason":"change_improvement","expenseType":"CAPEX","reasonDetail":"Замена - восстановление вышедшего из строя оборудования/ОС для улучшения состояния объекта, повышающего его первоначально оцененные нормативные показатели: срок службы, производственную мощность и т. д","$$hashKey":"object:4359","files":[{"name":"work_0_file_0","type":"Json","value":{"name":"62228SAGYZBAZA.doc","path":"5d4e4527-03b0-11eb-852a-0242ac120008/b388990b-27cb-11eb-a45d-0242ac120007/62228SAGYZBAZA.doc"},"$$hashKey":"object:280"},{"name":"work_0_file_1","type":"Json","value":{"name":"62228SAGYZBAZA.xls","path":"5d4e4527-03b0-11eb-852a-0242ac120008/b388990b-27cb-11eb-a45d-0242ac120007/62228SAGYZBAZA.xls"},"$$hashKey":"object:281"},{"name":"work_0_file_2","type":"Json","value":{"name":"62228SAGYZBAZA.pdf","path":"5d4e4527-03b0-11eb-852a-0242ac120008/b388990b-27cb-11eb-a45d-0242ac120007/62228SAGYZBAZA.pdf"},"$$hashKey":"object:282"}]}],"workPrices":[{"relatedSites":[{"name":"62228","id":"34732","site_name":"62228SAGYZBAZA","params":{"site_name":"62228SAGYZBAZA"},"$$hashKey":"object:4395"}],"displayServiceName":"2.47 Замена аккумуляторных батарей ;Комплект- 4шт","sapServiceNumber":"2.47","quantity":2,"materialQuantity":2,"reason":"change_improvement","expenseType":"CAPEX","reasonDetail":"Замена - восстановление вышедшего из строя оборудования/ОС для улучшения состояния объекта, повышающего его первоначально оцененные нормативные показатели: срок службы, производственную мощность и т. д","$$hashKey":"object:4359","unitWorkPricePerSite":"44400.00","netWorkPricePerSite":"88800.00","unitWorkPrice":"44400.00","unitWorkPricePlusTx":"44400.00","basePriceByQuantity":"88800.00","total":"88800.00","basePrice":"44400.00","materialsProvidedBy":"kcell"}],"dueDate":"2021-03-06T18:00:00.000Z","delay":6},"f6a304f5-03fd-11eb-852a-0242ac120008":{"selected":true,"businessKey":"N&C-Line_Eng-TNU-20-7004","processInstanceId":"f6a304f5-03fd-11eb-852a-0242ac120008","$$hashKey":"object:495","performDate":"2020-10-16T22:02:46.692+0600","priority":"regular","site_name":"12236PARTIZANKA","acceptanceDate":"2020-10-22T00:00:00.000+0600","contractorJobAssignedDate":"2020-10-14T22:08:49.396+0600","siteRegion":"nc","reason":"2","acceptWorkStartTime":"2020-10-16T22:02:46.692+0600","acceptWorkEndTime":"2020-10-22T00:00:00.000+0600","works":[{"relatedSites":[{"name":"12236","id":"30473","site_name":"12236PARTIZANKA","params":{"site_name":"12236PARTIZANKA"},"$$hashKey":"object:1029"}],"displayServiceName":"9.59 Монтаж кабеля/патчкорда UTP, KVSM, FO ;метр","sapServiceNumber":"9.59","materialUnit":"метр","quantity":47,"materialQuantity":47,"reason":"installation","expenseType":"CAPEX","reasonDetail":"Монтаж - установка нового оборудования","$$hashKey":"object:1002","files":[{"name":"work_0_file_0","type":"Json","value":{"name":"N&C-Line_Eng-TNU-20-7004_12236PARTIZANKA.rar","path":"f6a304f5-03fd-11eb-852a-0242ac120008/8ba77671-0e37-11eb-900c-0242ac120008/N&C-Line_Eng-TNU-20-7004_12236PARTIZANKA.rar"},"$$hashKey":"object:136"}]}],"workPrices":[{"relatedSites":[{"name":"12236","id":"30473","site_name":"12236PARTIZANKA","params":{"site_name":"12236PARTIZANKA"},"$$hashKey":"object:1029"}],"displayServiceName":"9.59 Монтаж кабеля/патчкорда UTP, KVSM, FO ;метр","sapServiceNumber":"9.59","materialUnit":"метр","quantity":47,"materialQuantity":47,"reason":"installation","expenseType":"CAPEX","reasonDetail":"Монтаж - установка нового оборудования","$$hashKey":"object:1002","unitWorkPricePerSite":"1306.44","netWorkPricePerSite":"61402.68","unitWorkPrice":"1306.44","unitWorkPricePlusTx":"1306.44","basePriceByQuantity":"61402.68","total":"61402.68","basePrice":"1306.44"}]}}'
//def selectedRevisionsObj = new JsonSlurper().parseText(selectedRevisions)

def binding = ["maNumber" : maNumber, "selectedRevisionsObj" : selectedRevisionsObj]

def template = '''\
yieldUnescaped '<!DOCTYPE html>'

html(lang:'en') {
    head {
        meta('http-equiv':'"Content-Type" content="text/html; charset=utf-8"')
        title('My page')
    }
    style ('td { padding: 10px; }')
    newLine()
    body {
    
    }
}
'''

def config = new TemplateConfiguration()
config.setAutoNewLine(true)
config.setAutoIndent(true)

def engine = new MarkupTemplateEngine(config)
def result = engine.createTemplate(template).make(binding).toString()

//print result

result
